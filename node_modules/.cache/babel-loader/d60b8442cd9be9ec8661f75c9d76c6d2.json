{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"Router\", {\n  enumerable: true,\n  get: function () {\n    return _router.default;\n  }\n});\nObject.defineProperty(exports, \"withRouter\", {\n  enumerable: true,\n  get: function () {\n    return _withRouter.default;\n  }\n});\nexports.useRouter = useRouter;\nexports.createRouter = createRouter;\nexports.makePublicRouterInstance = makePublicRouterInstance;\nexports.default = void 0;\n\nvar _interop_require_default = require(\"@swc/helpers/lib/_interop_require_default.js\").default;\n\nvar _react = _interop_require_default(require(\"react\"));\n\nvar _router = _interop_require_default(require(\"../shared/lib/router/router\"));\n\nvar _routerContext = require(\"../shared/lib/router-context\");\n\nvar _isError = _interop_require_default(require(\"../lib/is-error\"));\n\nvar _withRouter = _interop_require_default(require(\"./with-router\"));\n\nconst singletonRouter = {\n  router: null,\n  readyCallbacks: [],\n\n  ready(cb) {\n    if (this.router) return cb();\n\n    if (typeof window !== 'undefined') {\n      this.readyCallbacks.push(cb);\n    }\n  }\n\n}; // Create public properties and methods of the router in the singletonRouter\n\nconst urlPropertyFields = ['pathname', 'route', 'query', 'asPath', 'components', 'isFallback', 'basePath', 'locale', 'locales', 'defaultLocale', 'isReady', 'isPreview', 'isLocaleDomain', 'domainLocales'];\nconst routerEvents = ['routeChangeStart', 'beforeHistoryChange', 'routeChangeComplete', 'routeChangeError', 'hashChangeStart', 'hashChangeComplete'];\nconst coreMethodFields = ['push', 'replace', 'reload', 'back', 'prefetch', 'beforePopState']; // Events is a static property on the router, the router doesn't have to be initialized to use it\n\nObject.defineProperty(singletonRouter, 'events', {\n  get() {\n    return _router.default.events;\n  }\n\n});\n\nfunction getRouter() {\n  if (!singletonRouter.router) {\n    const message = 'No router instance found.\\n' + 'You should only use \"next/router\" on the client side of your app.\\n';\n    throw new Error(message);\n  }\n\n  return singletonRouter.router;\n}\n\nurlPropertyFields.forEach(field => {\n  // Here we need to use Object.defineProperty because we need to return\n  // the property assigned to the actual router\n  // The value might get changed as we change routes and this is the\n  // proper way to access it\n  Object.defineProperty(singletonRouter, field, {\n    get() {\n      const router = getRouter();\n      return router[field];\n    }\n\n  });\n});\ncoreMethodFields.forEach(field => {\n  singletonRouter[field] = function () {\n    const router = getRouter();\n    return router[field](...arguments);\n  };\n});\nrouterEvents.forEach(event => {\n  singletonRouter.ready(() => {\n    _router.default.events.on(event, function () {\n      const eventField = `on${event.charAt(0).toUpperCase()}${event.substring(1)}`;\n      const _singletonRouter = singletonRouter;\n\n      if (_singletonRouter[eventField]) {\n        try {\n          _singletonRouter[eventField](...arguments);\n        } catch (err) {\n          console.error(`Error when running the Router event: ${eventField}`);\n          console.error((0, _isError).default(err) ? `${err.message}\\n${err.stack}` : err + '');\n        }\n      }\n    });\n  });\n});\nvar _default = singletonRouter;\nexports.default = _default;\n\nfunction useRouter() {\n  const router = _react.default.useContext(_routerContext.RouterContext);\n\n  if (!router) {\n    throw new Error('NextRouter was not mounted. https://nextjs.org/docs/messages/next-router-not-mounted');\n  }\n\n  return router;\n}\n\nfunction createRouter() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  singletonRouter.router = new _router.default(...args);\n  singletonRouter.readyCallbacks.forEach(cb => cb());\n  singletonRouter.readyCallbacks = [];\n  return singletonRouter.router;\n}\n\nfunction makePublicRouterInstance(router) {\n  const scopedRouter = router;\n  const instance = {};\n\n  for (const property of urlPropertyFields) {\n    if (typeof scopedRouter[property] === 'object') {\n      instance[property] = Object.assign(Array.isArray(scopedRouter[property]) ? [] : {}, scopedRouter[property]) // makes sure query is not stateful\n      ;\n      continue;\n    }\n\n    instance[property] = scopedRouter[property];\n  } // Events is a static property on the router, the router doesn't have to be initialized to use it\n\n\n  instance.events = _router.default.events;\n  coreMethodFields.forEach(field => {\n    instance[field] = function () {\n      return scopedRouter[field](...arguments);\n    };\n  });\n  return instance;\n}\n\nif ((typeof exports.default === 'function' || typeof exports.default === 'object' && exports.default !== null) && typeof exports.default.__esModule === 'undefined') {\n  Object.defineProperty(exports.default, '__esModule', {\n    value: true\n  });\n  Object.assign(exports.default, exports);\n  module.exports = exports.default;\n}","map":{"version":3,"mappings":"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","names":["Router","withRouter","default","useRouter","createRouter","makePublicRouterInstance","singletonRouter","router","readyCallbacks","ready","cb","window","push","urlPropertyFields","routerEvents","coreMethodFields","Object","defineProperty","get","events","getRouter","message","Error","forEach","field","event","on","eventField","charAt","toUpperCase","substring","_singletonRouter","err","console","error","isError","stack","React","useContext","RouterContext","args","scopedRouter","instance","property","assign","Array","isArray"],"sources":["../../../src/client/router.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}