{"version":3,"file":"RAFManager.js","sources":["../src/RAFManager.js"],"sourcesContent":["/**\n *  RAFManager requestAnimationFrame Manager\n * \n *  Simple package\n * \n *  CODE:\n * \n * \t\t// Add to\n *  \t-- RAFManager.add(func);\n * \n *   \t// Add and carry parameters\n *  \t-- const func = data =>{ console.log(data) };\n *  \t-- RAFManager.add(func, 25, { msg:'hello world!' }); \n * \t\t\n * \t\t// remove\n *  \t-- RAFManager.remove(func);\n *  \t-- RAFManager.stop();\t\n*/\n\n// simple polyfill by https://gist.github.com/paulirish/1579671\n(function () {\n\tlet lastTime = 0;\n\tlet vendors = ['ms', 'moz', 'webkit', 'o'];\n\tfor (let x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n\t\twindow.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n\t\twindow.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame']\n\t\t\t|| window[vendors[x] + 'CancelRequestAnimationFrame'];\n\t}\n}());\n\nconst RAFManager = {\n\ttimer: 0,\n\tstate: 'stop',\n\tanimations: [],\n\n\tadd(callback, fps = 60, param = null) {\n\t\tconst n = 60 / fps;\n\t\tconst aniData = { callback, fps, n, param, i: 0 };\n\t\tthis.animations.push(aniData);\n\t\tif (this.animations.length >= 1) this.start();\n\n\t\treturn this;\n\t},\n\n\tgetIndex(callback) {\n\t\tfor (let i = 0; i < this.animations.length; i++) {\n\t\t\tconst aniData = this.animations[i];\n\t\t\tif (aniData.callback === callback) return i;\n\t\t}\n\n\t\treturn -1;\n\t},\n\n\tremove(callback) {\n\t\tconst index = this.getIndex(callback);\n\t\tif (index < 0) return;\n\n\t\tthis.deleteMap(callback);\n\t\tif (this.animations.length === 0) this.stop();\n\n\t\treturn this;\n\t},\n\n\tdeleteMap(callback) {\n\t\tconst index = this.getIndex(callback);\n\t\tconst aniData = this.animations[index];\n\t\tfor (let key in aniData) delete aniData[key];\n\n\t\tthis.animations.splice(index, 1);\n\t},\n\n\tstart() {\n\t\tif (this.state === 'start') return;\n\n\t\tthis.state = 'start';\n\t\tthis.tick();\n\t\treturn this;\n\t},\n\n\tstop() {\n\t\tif (this.state === 'stop') return;\n\n\t\tthis.state = 'stop';\n\t\tcancelAnimationFrame(this.timer);\n\t\treturn this;\n\t},\n\n\ttick() {\n\t\tthis.timer = requestAnimationFrame(() => { this.tick(); });\n\n\t\tfor (let i = 0; i < this.animations.length; i++) {\n\t\t\tconst aniData = this.animations[i];\n\t\t\tconst callback = aniData.callback;\n\t\t\tconst param = aniData.param;\n\n\t\t\taniData.i++;\n\t\t\tif (aniData.i >= aniData.n) {\n\t\t\t\tcallback(param);\n\t\t\t\taniData.i = 0;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport default RAFManager;"],"names":["vendors","x","length","window","requestAnimationFrame","cancelAnimationFrame","RAFManager","callback","fps","param","n","aniData","i","animations","push","start","index","getIndex","deleteMap","stop","key","splice","state","tick","timer"],"mappings":";;;;;;AAAA;;;;;;;;;;;;;;;;;;;;AAoBC,aAAY;KAERA,UAAU,CAAC,IAAD,EAAO,KAAP,EAAc,QAAd,EAAwB,GAAxB,CAAd;MACK,IAAIC,IAAI,CAAb,EAAgBA,IAAID,QAAQE,MAAZ,IAAsB,CAACC,OAAOC,qBAA9C,EAAqE,EAAEH,CAAvE,EAA0E;SAClEG,qBAAP,GAA+BD,OAAOH,QAAQC,CAAR,IAAa,uBAApB,CAA/B;SACOI,oBAAP,GAA8BF,OAAOH,QAAQC,CAAR,IAAa,sBAApB,KAC1BE,OAAOH,QAAQC,CAAR,IAAa,6BAApB,CADJ;;CALD,GAAD;;AAUA,IAAMK,aAAa;QACX,CADW;QAEX,MAFW;aAGN,EAHM;;IAAA,eAKdC,QALc,EAKoB;MAAxBC,GAAwB,uEAAlB,EAAkB;MAAdC,KAAc,uEAAN,IAAM;;MAC/BC,IAAI,KAAKF,GAAf;MACMG,UAAU,EAAEJ,kBAAF,EAAYC,QAAZ,EAAiBE,IAAjB,EAAoBD,YAApB,EAA2BG,GAAG,CAA9B,EAAhB;OACKC,UAAL,CAAgBC,IAAhB,CAAqBH,OAArB;MACI,KAAKE,UAAL,CAAgBX,MAAhB,IAA0B,CAA9B,EAAiC,KAAKa,KAAL;;SAE1B,IAAP;EAXiB;SAAA,oBAcTR,QAdS,EAcC;OACb,IAAIK,IAAI,CAAb,EAAgBA,IAAI,KAAKC,UAAL,CAAgBX,MAApC,EAA4CU,GAA5C,EAAiD;OAC1CD,UAAU,KAAKE,UAAL,CAAgBD,CAAhB,CAAhB;OACID,QAAQJ,QAAR,KAAqBA,QAAzB,EAAmC,OAAOK,CAAP;;;SAG7B,CAAC,CAAR;EApBiB;OAAA,kBAuBXL,QAvBW,EAuBD;MACVS,QAAQ,KAAKC,QAAL,CAAcV,QAAd,CAAd;MACIS,QAAQ,CAAZ,EAAe;;OAEVE,SAAL,CAAeX,QAAf;MACI,KAAKM,UAAL,CAAgBX,MAAhB,KAA2B,CAA/B,EAAkC,KAAKiB,IAAL;;SAE3B,IAAP;EA9BiB;UAAA,qBAiCRZ,QAjCQ,EAiCE;MACbS,QAAQ,KAAKC,QAAL,CAAcV,QAAd,CAAd;MACMI,UAAU,KAAKE,UAAL,CAAgBG,KAAhB,CAAhB;OACK,IAAII,GAAT,IAAgBT,OAAhB;UAAgCA,QAAQS,GAAR,CAAP;GAEzB,KAAKP,UAAL,CAAgBQ,MAAhB,CAAuBL,KAAvB,EAA8B,CAA9B;EAtCiB;MAAA,mBAyCV;MACH,KAAKM,KAAL,KAAe,OAAnB,EAA4B;;OAEvBA,KAAL,GAAa,OAAb;OACKC,IAAL;SACO,IAAP;EA9CiB;KAAA,kBAiDX;MACF,KAAKD,KAAL,KAAe,MAAnB,EAA2B;;OAEtBA,KAAL,GAAa,MAAb;uBACqB,KAAKE,KAA1B;SACO,IAAP;EAtDiB;KAAA,kBAyDX;;;OACDA,KAAL,GAAapB,sBAAsB,YAAM;SAAOmB,IAAL;GAA9B,CAAb;;OAEK,IAAIX,IAAI,CAAb,EAAgBA,IAAI,KAAKC,UAAL,CAAgBX,MAApC,EAA4CU,GAA5C,EAAiD;OAC1CD,UAAU,KAAKE,UAAL,CAAgBD,CAAhB,CAAhB;OACML,WAAWI,QAAQJ,QAAzB;OACME,QAAQE,QAAQF,KAAtB;;WAEQG,CAAR;OACID,QAAQC,CAAR,IAAaD,QAAQD,CAAzB,EAA4B;aAClBD,KAAT;YACQG,CAAR,GAAY,CAAZ;;;;CApEJ;;;;;;;;"}